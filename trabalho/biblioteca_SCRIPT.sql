-- MySQL Script generated by MySQL Workbench
-- Tue Apr 22 21:02:01 2025
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
-- -----------------------------------------------------
-- Schema biblioteca
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema biblioteca
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `biblioteca` DEFAULT CHARACTER SET utf8mb3 ;
USE `biblioteca` ;

-- -----------------------------------------------------
-- Table `biblioteca`.`autor`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `biblioteca`.`autor` (
  `id_autor` INT NOT NULL,
  `autor_nome` VARCHAR(45) NOT NULL,
  `nacionalidade` VARCHAR(45) NOT NULL,
  `data_nascimento` DATE NOT NULL,
  PRIMARY KEY (`id_autor`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `biblioteca`.`usuario`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `biblioteca`.`usuario` (
  `id_usuario` INT NOT NULL,
  `usuario_nome` VARCHAR(45) NOT NULL,
  `data_cadastro` DATE NOT NULL,
  `cpf` VARCHAR(14) NULL,
  PRIMARY KEY (`id_usuario`),
  UNIQUE INDEX `cpf_UNIQUE` (`cpf` ASC) VISIBLE)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `biblioteca`.`reservas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `biblioteca`.`reservas` (
  `id_reservas` INT NOT NULL,
  `data_reserva` DATE NOT NULL,
  `status_reserva` TINYINT NOT NULL,
  PRIMARY KEY (`id_reservas`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `biblioteca`.`livro`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `biblioteca`.`livro` (
  `id_livro` INT NOT NULL,
  `ano_publicacao` DATE NOT NULL,
  `genero` VARCHAR(45) NOT NULL,
  `descricao` TEXT NULL DEFAULT NULL,
  `disponibilidade` TINYINT NOT NULL,
  `autor_id_autor` INT NOT NULL,
  PRIMARY KEY (`id_livro`),
  INDEX `fk_livro_autor1_idx` (`autor_id_autor` ASC) VISIBLE,
  CONSTRAINT `fk_livro_autor1`
    FOREIGN KEY (`autor_id_autor`)
    REFERENCES `biblioteca`.`autor` (`id_autor`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


-- -----------------------------------------------------
-- Table `biblioteca`.`emprestimo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `biblioteca`.`emprestimo` (
  `id_emprestimo` INT NOT NULL,
  `data_emprestimo` DATE NOT NULL,
  `data_dev_prev` DATE NULL,
  `data_dev_real` DATE,
  `status_emprestimo` TINYINT NOT NULL,
  `usuario_id_usuario` INT NOT NULL,
  `reservas_id_reservas` INT NOT NULL,
  `livro_id_livro` INT NOT NULL,
  PRIMARY KEY (`id_emprestimo`),
  INDEX `fk_emprestimo_usuario_idx` (`usuario_id_usuario` ASC) VISIBLE,
  INDEX `fk_emprestimo_reservas1_idx` (`reservas_id_reservas` ASC) VISIBLE,
  INDEX `fk_emprestimo_livro1_idx` (`livro_id_livro` ASC) VISIBLE,
  CONSTRAINT `fk_emprestimo_usuario`
    FOREIGN KEY (`usuario_id_usuario`)
    REFERENCES `biblioteca`.`usuario` (`id_usuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_emprestimo_reservas1`
    FOREIGN KEY (`reservas_id_reservas`)
    REFERENCES `biblioteca`.`reservas` (`id_reservas`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_emprestimo_livro1`
    FOREIGN KEY (`livro_id_livro`)
    REFERENCES `biblioteca`.`livro` (`id_livro`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb3;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- Inserindo dados na tabela `autor`
INSERT INTO `biblioteca`.`autor` (`id_autor`, `autor_nome`, `nacionalidade`, `data_nascimento`) VALUES
(1, 'Jorge Amado', 'Brasileiro', '1912-08-10'),
(2, 'Gabriel García Márquez', 'Colombiano', '1927-03-06'),
(3, 'Clarice Lispector', 'Brasileira', '1920-12-10');

-- Inserindo dados na tabela `usuario`
INSERT INTO `biblioteca`.`usuario` (`id_usuario`, `usuario_nome`, `data_cadastro`, `cpf`) VALUES
(1, 'Ana Silva', '2025-04-01', '123.456.789-00'),
(2, 'Carlos Oliveira', '2025-04-02', '987.654.321-11'),
(3, 'Maria Santos', '2025-04-03', NULL);

-- Inserindo dados na tabela `reservas`
INSERT INTO `biblioteca`.`reservas` (`id_reservas`, `data_reserva`, `status_reserva`) VALUES
(1, '2025-04-10', 1),
(2, '2025-04-11', 0),
(3, '2025-04-12', 1);

-- Inserindo dados na tabela `livro`
INSERT INTO `biblioteca`.`livro` (`id_livro`, `ano_publicacao`, `genero`, `descricao`, `disponibilidade`, `autor_id_autor`) VALUES
(1, '1958-01-01', 'Romance', 'Uma história fascinante sobre o sertão brasileiro.', 1, 1),
(2, '1967-01-01', 'Realismo Mágico', 'Obra-prima da literatura mundial.', 1, 2),
(3, '1977-01-01', 'Contos', 'Coletânea de contos introspectivos.', 0, 3);

-- Inserindo dados na tabela `emprestimo`
INSERT INTO `biblioteca`.`emprestimo` (`id_emprestimo`, `data_emprestimo`, `data_dev_prev`, `data_dev_real`, `status_emprestimo`, `usuario_id_usuario`, `reservas_id_reservas`, `livro_id_livro`) VALUES
(1, '2025-04-15', '2025-04-22', '2025-04-21', 1, 1, 1, 1),
(2, '2025-04-16', '2025-04-23', '2025-04-25', 0, 2, 2, 2),
(3, '2025-04-17', '2025-04-24', NULL, 1, 3, 3, 3);

-- Inserindo a minha mãe na tabela usuário
INSERT INTO `biblioteca`.`usuario` (`id_usuario`, `usuario_nome`, `data_cadastro`, `cpf`) VALUES
(4, "Wallkeyla Almeida de Alencar Lerbach", "2024-12-20", NULL);

-- Criando a reserva da minha mãe
INSERT INTO `biblioteca`.`reservas` (`id_reservas`, `data_reserva`, `status_reserva`) VALUES
(4, "2025-04-21", 0);

-- Inserindo o empréstimo da minha mãe
INSERT INTO `biblioteca`.`emprestimo` (`id_emprestimo`, `data_emprestimo`, `data_dev_prev`, `data_dev_real`, `status_emprestimo`, `usuario_id_usuario`, `reservas_id_reservas`, `livro_id_livro`) VALUES
(4, "2025-04-22", "2025-05-03", NULL, 0, 4, 4, 2);